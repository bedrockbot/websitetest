<div id="info">Hoi!</div>
<div id="linker">Not linked to Roblox</div>
<a id="login" style="display: none;" href="https://discord.com/api/oauth2/authorize?client_id=732263433579397151&redirect_uri=http%3A%2F%2Flocalhost%3A3000/oauth2&response_type=token&scope=identify">Identify Yourself</a>
<script>
	window.onload = () => {


		function getCookie(cname) {
		let name = cname + "=";
		let decodedCookie = decodeURIComponent(document.cookie);
		let ca = decodedCookie.split(';');
		for(let i = 0; i <ca.length; i++) {
			let c = ca[i];
			while (c.charAt(0) == ' ') {
			c = c.substring(1);
			}
			if (c.indexOf(name) == 0) {
			return c.substring(name.length, c.length);
			}
		}
		return "";
		}



		
		const [accessToken, tokenType] = [getCookie("access_token"), getCookie("token_type")];
		if (!accessToken) {
			return (document.getElementById('login').style.display = 'block');
		}

		fetch('https://discord.com/api/users/@me', {
			headers: {
				authorization: `${tokenType} ${accessToken}`,
			},
		})
		.then(result => result.json())
		.then(response => {
			const { username, discriminator } = response;
			document.getElementById('info').innerText += ` ${username}#${discriminator}`;
				
		})
		.catch(console.error);
		fetch('https://my-botssss.herokuapp.com/api/roblox/users', {
				headers: {
					authorization: `${tokenType} ${accessToken}`,
				},
			})
			.then(result => result.json())
			.then(response => {
				if (response.name) {
					const { name } = response;
					document.getElementById('linker').innerText = `Roblox account: ${name}`;
				}
					
			})
		.catch(console.error);
		
	};
</script>